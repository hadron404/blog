{"title":"认证授权系统设计【零】认证、授权、鉴权和权限控制","date":"2023-03-25T20:37:01.000Z","date_formatted":{"ll":"Mar 25, 2023","L":"03/25/2023","MM-DD":"03-25"},"link":"2023/03/25/auth-system-design","tags":["Authentication & Authorization"],"categories":["system-design"],"updated":"2023-04-11T15:08:37.571Z","content":"<h2 id=\"authentication：认证\">Authentication：认证<a title=\"#authentication：认证\" href=\"#authentication：认证\"></a></h2>\n<h3 id=\"概念\">概念<a title=\"#概念\" href=\"#概念\"></a></h3>\n<p>首先来看一下英文中的对 Authentication 的解释：</p>\n<p><a href=\"https://dictionary.cambridge.org/dictionary/english/authentication\" target=\"_blank\">Cambridge Dictionary</a></p>\n<blockquote>\n<p>the process of proving that something is real, true, or what people say it is</p>\n</blockquote>\n<p><a href=\"https://www.merriam-webster.com/dictionary/authentication\" target=\"_blank\">Merriam-webster Dictionary</a></p>\n<blockquote>\n<p>: an act, process, or method of showing something (such as an identity, a piece of art,<br>\nor a financial transaction) to be real, true, or genuine <br><br>\n: the act or process of authenticating something</p>\n</blockquote>\n<p><a href=\"https://en.wikipedia.org/wiki/Authentication\" target=\"_blank\">Wikipedia</a></p>\n<blockquote>\n<p>Authentication is the act of proving an assertion,<br>\nsuch as the identity of a computer system user.<br>\nIn contrast with identification, the act of indicating a person or thing’s identity,<br>\nauthentication is the process of verifying that identity.<br>\nIt might involve validating personal identity documents,<br>\nverifying the authenticity of a website with a digital certificate,<br>\ndetermining the age of an artifact by carbon dating,<br>\nor ensuring that a product or document is not counterfeit.</p>\n</blockquote>\n<p>它通常会与 Authorization 和 Authenticity 混淆，<strong>简单地说，验证用户身份的过程，<br>\n按照国际惯例称为 身份验证</strong>，也可以简称为 <strong>认证</strong>（以下均以认证称之）。</p>\n<h3 id=\"目的\">目的<a title=\"#目的\" href=\"#目的\"></a></h3>\n<p>认证的目的是确保只有合法的用户才能访问系统和资源。</p>\n<h3 id=\"主要任务和其实现时的注意点\">主要任务和其实现时的注意点<a title=\"#主要任务和其实现时的注意点\" href=\"#主要任务和其实现时的注意点\"></a></h3>\n<h4 id=\"主要任务\">主要任务<a title=\"#主要任务\" href=\"#主要任务\"></a></h4>\n<ul>\n<li>收集用户身份验证信息</li>\n<li>验证用户身份</li>\n<li>记录身份验证结果</li>\n<li>处理身份验证错误</li>\n</ul>\n<h4 id=\"注意点\">注意点<a title=\"#注意点\" href=\"#注意点\"></a></h4>\n<h6 id=\"安全性\">安全性<a title=\"#安全性\" href=\"#安全性\"></a></h6>\n<p>认证系统需要确保用户身份验证信息的安全性。这包括保护用户信息的隐私和防止未经授权的访问</p>\n<h6 id=\"性能\">性能<a title=\"#性能\" href=\"#性能\"></a></h6>\n<p>认证系统需要确保高性能，以便在大量用户同时访问系统时仍能快速验证用户的身份</p>\n<h6 id=\"可伸缩性\">可伸缩性<a title=\"#可伸缩性\" href=\"#可伸缩性\"></a></h6>\n<p>认证系统需要具备可伸缩性，以便随着用户数量的增长而扩展</p>\n<h6 id=\"可靠性\">可靠性<a title=\"#可靠性\" href=\"#可靠性\"></a></h6>\n<p>认证系统需要确保可靠性，以避免出现故障或停机时间过长，导致用户无法访问系统</p>\n<h3 id=\"常见的认证方案\">常见的认证方案<a title=\"#常见的认证方案\" href=\"#常见的认证方案\"></a></h3>\n<ul>\n<li>HTTP Basic Authentication</li>\n<li>基于 Session 的认证\n<ul>\n<li>基于单体架构的 Session 方案</li>\n<li>基于分布式架构的 Session 方案</li>\n</ul>\n</li>\n<li>基于 Token 的认证\n<ul>\n<li>基于 JWT 的方案</li>\n<li>基于 OAuth 的方案</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"常规的认证形式\">常规的认证形式<a title=\"#常规的认证形式\" href=\"#常规的认证形式\"></a></h3>\n<ol>\n<li>账号密码认证</li>\n<li>短信认证</li>\n<li>第三方 IDP 认证\n<ol>\n<li>Google</li>\n<li>Github</li>\n<li>QQ</li>\n</ol>\n</li>\n</ol>\n<h2 id=\"authorization：授权\">Authorization：授权<a title=\"#authorization：授权\" href=\"#authorization：授权\"></a></h2>\n<h3 id=\"概念-1\">概念<a title=\"#概念-1\" href=\"#概念-1\"></a></h3>\n<p><a href=\"https://dictionary.cambridge.org/dictionary/english/authorization\" target=\"_blank\">Cambridge Dictionary</a></p>\n<blockquote>\n<p>official permission for something to happen,<br>\nor the act of giving someone official permission to do something:<br><br>\nMedical records cannot be disclosed without authorization from the patient.<br><br>\n[ + to infinitive ] The authorization to sell the shares arrived too late.</p>\n</blockquote>\n<p><a href=\"https://www.merriam-webster.com/dictionary/authorization\" target=\"_blank\">Merriam-webster Dictionary</a></p>\n<blockquote>\n<p>: the act of authorizing<br><br>\n: an instrument that authorizes : SANCTION</p>\n</blockquote>\n<p><a href=\"https://en.wikipedia.org/wiki/Authorization\" target=\"_blank\">Wikipedia</a></p>\n<blockquote>\n<p>Authorization or authorisation (see spelling differences) is the function of specifying access rights/privileges to resources,<br>\nwhich is related to general information security and computer security,<br>\nand to access control in particular.</p>\n</blockquote>\n<p><em>Authorization（授权）是确定用户能够访问哪些资源的过程。</em></p>\n<p>一般是在 <strong>Authentication（认证） 成功之后，根据用户身份和权限规则， 决定用户是否有权访问所请求的资源或执行某些操作的过程</strong></p>\n<h3 id=\"目的-1\">目的<a title=\"#目的-1\" href=\"#目的-1\"></a></h3>\n<p>授权的目的是确保用户只能访问其被授权的资源，而不能访问未经授权的资源。</p>\n<h3 id=\"主要任务和实现时注意点\">主要任务和实现时注意点<a title=\"#主要任务和实现时注意点\" href=\"#主要任务和实现时注意点\"></a></h3>\n<h4 id=\"主要任务-1\">主要任务<a title=\"#主要任务-1\" href=\"#主要任务-1\"></a></h4>\n<ul>\n<li>确定用户的身份和权限</li>\n<li>检查用户是否有权访问权限</li>\n<li>记录授权结果</li>\n<li>处理授权错误</li>\n</ul>\n<h4 id=\"注意点-1\">注意点<a title=\"#注意点-1\" href=\"#注意点-1\"></a></h4>\n<h6 id=\"安全性-1\">安全性<a title=\"#安全性-1\" href=\"#安全性-1\"></a></h6>\n<p>授权系统需要确保资源的安全性，包括对访问资源的限制和保护，以避免未经授权的访问</p>\n<h6 id=\"精细控制\">精细控制<a title=\"#精细控制\" href=\"#精细控制\"></a></h6>\n<p>授权系统需要实现细粒度的访问控制，以确保每个用户仅访问其被授权的资源<br>\n是授权(Authorization）中的一部分，用于决定用户是否可以访问某个资源或执行某个操作。<br>\n常用的访问控制模型，两种 RBAC ：</p>\n<ul>\n<li>基于资源的权限访问控制（Resource-based access control，RBAC）</li>\n<li>基于角色的权限访问控制（Role-based access control，RBAC）</li>\n</ul>\n<h6 id=\"可伸缩性-1\">可伸缩性<a title=\"#可伸缩性-1\" href=\"#可伸缩性-1\"></a></h6>\n<p>授权系统需要具备可伸缩性，以便随着用户数量的增长而扩展</p>\n<h6 id=\"可靠性-1\">可靠性<a title=\"#可靠性-1\" href=\"#可靠性-1\"></a></h6>\n<p>授权系统需要确保可靠性，以避免出现故障或停机时间过长，导致用户无法访问系统</p>\n<h2 id=\"authentication-and-authorization：鉴权\">Authentication and Authorization：鉴权<a title=\"#authentication-and-authorization：鉴权\" href=\"#authentication-and-authorization：鉴权\"></a></h2>\n<h3 id=\"概念-2\">概念<a title=\"#概念-2\" href=\"#概念-2\"></a></h3>\n<h4 id=\"鉴\">鉴<a title=\"#鉴\" href=\"#鉴\"></a></h4>\n<blockquote>\n<p>◎ 镜子。<br><br>\n◎ 照：光可鉴人。<br><br>\n◎ 观察，审察：鉴别。鉴定。鉴赏。鉴于（看到，觉察到）。台鉴（书信用语，表示请人看信。亦作“惠鉴”、“钧鉴”）。鉴往知来。<br><br>\n◎ 可以使人警惕或引为教训的事情：借鉴。鉴戒。前车之鉴<br></p>\n</blockquote>\n<h4 id=\"权\">权<a title=\"#权\" href=\"#权\"></a></h4>\n<blockquote>\n<p>◎ 职责范围内支配和指挥的力量：政权。权力。权威。权贵。权柄。权势。生杀予夺之权。<br><br>\n◎ 有利的形势：主动权。<br><br>\n◎ 变通，不依常规：权变。权谋（随机应变的计谋）。权术。智必知权。<br><br>\n◎ 暂且，姑且：权且。<br><br>\n◎ 秤锤：权衡。<br><br>\n◎ 衡量，估计：权其轻重。<br><br>\n◎ 姓。<br></p>\n</blockquote>\n<p>这里主要指的是权力了，在计算机世界中，权力就是访问资源的权力了，即权限。<br>\n实际是认证和授权两个过程的合并，称之为 <strong>鉴权</strong> 。</p>\n<h3 id=\"目的-2\">目的<a title=\"#目的-2\" href=\"#目的-2\"></a></h3>\n<p>鉴权的目的是同时验证用户的身份和授权信息，以决定用户是否有权访问所请求的资源。一般是先认证，后授权，<br>\n整个认证授权的过程在中文语境下称之为鉴权。英文语境下是 Authentication and Authorization 。<br>\n比如 <a href=\"https://zh.wikipedia.org/wiki/JAAS\" target=\"_blank\">JAAS</a>， Java Authentication and Authorization Server。</p>\n<h3 id=\"常见的技术实现方案\">常见的技术实现方案<a title=\"#常见的技术实现方案\" href=\"#常见的技术实现方案\"></a></h3>\n<ul>\n<li>客户端 Token 与 API 网关结合</li>\n<li>客户端 Token 方案</li>\n<li>分布式 Session 方案</li>\n<li>Single Sign On，即单点登录，用于解决多个应用系统之间的身份认证和访问控制\n<ul>\n<li>基于 父域 Cookie 子域共享方案</li>\n<li>基于 CAS 的实现</li>\n<li>基于 OAuth 的实现</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"权限控制\">权限控制<a title=\"#权限控制\" href=\"#权限控制\"></a></h2>\n<p>权限控制是指对可执行的各种操作组合配置为权限列表，然后根据执行者的权限，若其操作在权限范围内，<br>\n则允许执行，否则禁止。权限控制在英文中对应于 access/permission control 。</p>\n","prev":{"title":"认证授权系统设计【二】完整的认证授权系统设计方案","link":"2023/03/26/auth-system-design-2"},"next":{"title":"研发工程师想要提高面试竞争力，应具备的三个技术认知","link":"2023/03/24/interview-architecture-design-1"},"plink":"https://hadron404.github.io/blog/2023/03/25/auth-system-design/","toc":[{"id":"authentication：认证","title":"Authentication：认证","index":"1","children":[{"id":"概念","title":"概念","index":"1.1"},{"id":"目的","title":"目的","index":"1.2"},{"id":"主要任务和其实现时的注意点","title":"主要任务和其实现时的注意点","index":"1.3"},{"id":"常见的认证方案","title":"常见的认证方案","index":"1.4"},{"id":"常规的认证形式","title":"常规的认证形式","index":"1.5"}]},{"id":"authorization：授权","title":"Authorization：授权","index":"2","children":[{"id":"概念-1","title":"概念","index":"2.1"},{"id":"目的-1","title":"目的","index":"2.2"},{"id":"主要任务和实现时注意点","title":"主要任务和实现时注意点","index":"2.3"}]},{"id":"authentication-and-authorization：鉴权","title":"Authentication and Authorization：鉴权","index":"3","children":[{"id":"概念-2","title":"概念","index":"3.1"},{"id":"目的-2","title":"目的","index":"3.2"},{"id":"常见的技术实现方案","title":"常见的技术实现方案","index":"3.3"}]},{"id":"权限控制","title":"权限控制","index":"4"}],"reading_time":"1431 words in 10 min"}